<!doctype html>
<html lang="en" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="./assets/styles/main.css" />
    <title>Details form</title>
  </head>

  <body>
    <div class="cloud-layer"></div>

    <div class="input-group">
      <label for="first-name">×©× ×¤×¨×˜×™ ×”×•×¨×”</label>
      <input
        type="text"
        id="first-name"
        name="first_name"
        class="keyboard-input"
        required
      />
    </div>

    <!-- ================= CUSTOM KEYBOARD ================= -->
    <div class="keyboard-text-container">
      <button class="close-btn" onclick="submitOk()">âœ•</button>

      <!-- NUMBERS (STATIC - NEVER TOUCHED) -->
      <div class="keyboard-text-row">
        <button class="data-number key" data-key="1">1</button>
        <button class="data-number key" data-key="2">2</button>
        <button class="data-number key" data-key="3">3</button>
        <button class="data-number key" data-key="4">4</button>
        <button class="data-number key" data-key="5">5</button>
        <button class="data-number key" data-key="6">6</button>
        <button class="data-number key" data-key="7">7</button>
        <button class="data-number key" data-key="8">8</button>
        <button class="data-number key" data-key="9">9</button>
        <button class="data-number key" data-key="0">0</button>
      </div>

      <!-- LETTER ROW 1 -->
      <div class="keyboard-text-row lang-row">
        <button class="data-number key"></button>
        <button class="data-number key"></button>
        <button class="data-number key"></button>
        <button class="data-number key"></button>
        <button class="data-number key"></button>
        <button class="data-number key"></button>
        <button class="data-number key"></button>
        <button class="data-number key"></button>
      </div>

      <!-- LETTER ROW 2 -->
      <div class="keyboard-text-row lang-row">
        <button class="data-number key"></button>
        <button class="data-number key"></button>
        <button class="data-number key"></button>
        <button class="data-number key"></button>
        <button class="data-number key"></button>
        <button class="data-number key"></button>
        <button class="data-number key"></button>
        <button class="data-number key"></button>
        <button class="data-number key"></button>
        <button class="data-number key"></button>
      </div>

      <!-- LETTER ROW 3 -->
      <div class="keyboard-text-row lang-row">
        <button class="data-number key"></button>
        <button class="data-number key"></button>
        <button class="data-number key"></button>
        <button class="data-number key"></button>
        <button class="data-number key"></button>
        <button class="data-number key"></button>
        <button class="data-number key"></button>
        <button class="data-number key"></button>
        <button class="data-number key"></button>
      </div>

      <!-- ACTIONS -->
      <div class="keyboard-text-row actions">
        <button class="data-number" onclick="toggleLang()">ğŸŒ</button>

        <button class="data-number data-space" onclick="addCharX(' ')"></button>

        <button class="data-number data-delete" onclick="deleteChar()">
          âŒ«
        </button>

        <button class="data-number data-ok" onclick="submitOk()">×©××™×¨×”</button>
      </div>
    </div>

    <!-- ================= SCRIPT ================= -->
    <script>
      (function () {
        let currentInput = null;
        let currentLang = "he";

        const keyboard = document.querySelector(".keyboard-text-container");
        const allInputs = document.querySelectorAll(".keyboard-input");

        const layouts = {
          he: [
            ["×§", "×¨", "×", "×˜", "×•", "×Ÿ", "×", "×¤"],
            ["×©", "×“", "×’", "×›", "×¢", "×™", "×—", "×œ", "×š", "×£"],
            ["×–", "×¡", "×‘", "×”", "× ", "×", "×¦", "×ª", "×¥"],
          ],
          en: [
            ["q", "w", "e", "r", "t", "y", "u", "i", "o", "p"],
            ["a", "s", "d", "f", "g", "h", "j", "k", "l", "@"],
            ["z", "x", "c", "v", "b", "n", "m", ".", "_", "-"],
          ],
        };

        function renderKeys() {
          const rows = document.querySelectorAll(".lang-row");
          const layout = layouts[currentLang];

          rows.forEach((row, rowIndex) => {
            const buttons = row.querySelectorAll(".key");
            const rowKeys = layout[rowIndex] || [];

            buttons.forEach((btn, i) => {
              const val = rowKeys[i] || "";
              btn.textContent = val;
              btn.dataset.key = val;
              btn.onclick = () => addCharX(val);
            });
          });

          document.documentElement.dir = currentLang === "he" ? "ltr" : "ltr";
        }

        window.toggleLang = function () {
          currentLang = currentLang === "he" ? "en" : "he";
          renderKeys();
        };

        function showKeyboard(input) {
          currentInput = input;
          keyboard.classList.add("is-open");
          renderKeys();
          moveCaretToEnd(input);
        }

        function hideKeyboard() {
          keyboard.classList.remove("is-open");
          currentInput = null;
        }

        function moveCaretToEnd(input) {
          input.focus();
          const val = input.value;
          input.value = "";
          input.value = val;
        }

        window.addCharX = function (val) {
          if (!currentInput || !val) return;
          currentInput.value += val;
          moveCaretToEnd(currentInput);
        };

        window.deleteChar = function () {
          if (!currentInput) return;
          currentInput.value = currentInput.value.slice(0, -1);
          moveCaretToEnd(currentInput);
        };

        window.submitOk = function () {
          hideKeyboard();
        };

        allInputs.forEach((input) => {
          input.addEventListener("focus", () => showKeyboard(input));
          input.addEventListener("click", () => showKeyboard(input));
        });
      })();
    </script>
  </body>
</html>
